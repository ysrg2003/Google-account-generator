name: Enterprise Web Automation Engine

on:
  workflow_dispatch: # ØªØ´ØºÙŠÙ„ ÙŠØ¯ÙˆÙŠ Ø¯Ù‚ÙŠÙ‚

jobs:
  run-core:
    runs-on: ubuntu-latest
    timeout-minutes: 15 # Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠ

    steps:
      - name: ğŸ“¥ Ø³Ø­Ø¨ Ø§Ù„ÙƒÙˆØ¯
        uses: actions/checkout@v4

      - name: ğŸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨Ø§ÙŠØ«ÙˆÙ† 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: âš¡ ÙƒØ§Ø´ Ø§Ù„Ù…ØªØµÙØ­ ÙˆØ§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ÙŠØ§Øª
        uses: actions/cache@v4
        id: cache-deps
        with:
          path: |
            ~/.cache/pip
            ~/.cache/ms-playwright
          key: ${{ runner.os }}-automation-v1-${{ hashFiles('**/requirements.txt') }}

      - name: ğŸ› ï¸ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…Ø­Ø±Ùƒ (Silent Mode)
        run: |
          pip install -r requirements.txt
          if [ "${{ steps.cache-deps.outputs.cache-hit }}" != "true" ]; then
            python -m playwright install firefox --with-deps
          fi
          sudo python -m playwright install-deps firefox

      - name: ğŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø±Ùƒ (Deep Execution)
        run: python main.py
        env:
          PYTHONUNBUFFERED: 1 # Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø³Ø¬Ù„Ø§Øª ÙÙˆØ±Ø§Ù‹ ÙÙŠ GitHub

      - name: ğŸ“Š ØªØµØ¯ÙŠØ± Ø§Ù„Ø­Ø²Ù…Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚ÙŠØ© (Full Artifact)
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: Full-Trace-Report-${{ github.run_id }}
          path: report_Google_Signup_Deep_Trace/
          retention-days: 14 # Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…Ø¯Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†
